<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="alexu@cloudgeometry.io" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Atlantis - CG DevX Guide</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Atlantis";
        var mkdocs_page_input_path = "under_the_hood/delivery_pipelines/atlantis.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/hcl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> CG DevX Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">CG DevX</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../platform_engineering/">Platform Engineering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../cgdevx/">Why CG DevX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../approach/">Concept</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Capabilities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/capabilities/">Capabilities Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/reference_implementation/">Reference Implementation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/known_limitations/">Shared Responsibility</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tools/">Acknowledgements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Operators Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../operators_guide/concept/">Concept</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../operators_guide/supported_platforms/">Platforms and providers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Installation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/installation/quickstart/">Installation process</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">CLI</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/installing_cli/">Installing CG DevX CLI</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/building_cli/">Building CG DevX CLI</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/cli_commands/">CG DevX CLI commands</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Cloud</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/cloud/aws_setup/">Deploying on AWS</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/cloud/azure_setup/">Deploying on Azure</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/cloud/gcp_setup/">Deploying on Google Cloud</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Git</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/vcs/github_setup/">Using GitHub</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/installation/vcs/gitlab_setup/">Using GitLab</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Platform Management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/platform_management/platform_repo/">CG DevX platform GitOps repository</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Terraform</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/iac/vcs_management/">VCS management</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/iac/core_infrastructure_management/">Platform infrastructure</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/iac/secrets_management/">Secrets management</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/iac/users_management/">User management</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/iac/core_services/">Core platform services</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Services</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/delivery/">Delivery</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/integration/">Integration</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/monitoring/">Monitoring</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/registry/">Registry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/secrets/">Secrets Management</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../operators_guide/platform_management/services/security/">Security</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Workload Management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/workload_management/workloads/">Workloads Quickstart Guide</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/workload_management/cli_commands/">CG DevX CLI Workload Management commands</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/workload_management/bootstrap_templates/">Bootstrap templates</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/workload_management/environments/">Workload Environments</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Delivery Pipelines</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../operators_guide/delivery_pipelines/core_services_delivery/">Delivery Pipelines</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developers Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/getting_started/">How to Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/concept/">Concept</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Workloads</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/workloads/concept/">Workload concept</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/workloads/gitops_environments/">How to Model Your Environments</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Pipelines</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/cd/delivery/">Continuous Delivery with ArgoCD</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/cd/promotion/">Promotion</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/integration/">Integration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/argo_workflows/">Argo workflows: basic flows and templates</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/github_action_workflow/">Github Action Workflow Structure</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/build_routine/">Build routine execution</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/kaniko_build/">Image build: Kaniko</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/megalinter/">Megalinter</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/trivy/">Trivy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/code_quality/">Code quality</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/ci/devsecops/">Devsecops</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Observability</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/observability/monitoring/">Monitoring</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/observability/dashboards/">List of Dashboards</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/observability/log_management/">Log management</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Artifacts</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/artifacts/registry/">Registry</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../developers_guide/artifacts/registry_proxy/">Registry proxy</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Under the hood</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Architecture</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../architecture/">Under the hood</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../iam/iam/">IAM</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/networking/">Networking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../devsecops/devsecops/">DevSecOps</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../observability/observability/">Observability</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../runtime/runtime/">Runtime</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../delivery_pipelines/">Delivery Pipelines</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../argo_cleanup/">Argo workflows cleanup options</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../argo_config/">Argo workflows configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../argo_permissions/">Argo workflows permission scopes</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Atlantis</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#git-access">Git Access</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cloud-access">Cloud Access</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cost_management/cost_management/">Cost Management</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../workloads/workload_management/">Workload Management</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">CG DevX Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Under the hood</li>
          <li class="breadcrumb-item">Architecture</li>
      <li class="breadcrumb-item active">Atlantis</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="atlantis">Atlantis</h1>
<p>Atlantis is used as PR automation tool for IaC part of GitOps. The goal is to:</p>
<ul>
<li>Centralize IaC execution</li>
<li>Allow revocation of write access to infrastructure from the team</li>
<li>Provide visibility on IaC changes and serve as audit log</li>
</ul>
<p>As Git (users, teams, repositories) and cloud infrastructure are managed using IaC, Atlantis must have sufficient
permission to manage them.</p>
<h3 id="git-access">Git Access</h3>
<p>To manage Git Atlantis is using a user associated with Git access token provided during setup process.
This token is stored as a secret in Vault during platform provisioning proces.
Atlantis reads secrets including ATLANTIS_GH_TOKEN from environment variables, which are loaded from Vault
by external secret operator from <code>atlantis-envs-secrets</code>.
Full list of variables used by Atlantis is defined in your platform GitOps
repository <code>platform/terraform/modules/secrets_vault/secrets.tf</code></p>
<p>The concept is described in the Atlantis documentation and GitHub guidance:</p>
<blockquote>
<p>Creating an Atlantis User (Optional): It's recommended to create a new user named @atlantis or use a dedicated CI user
for clarity, although this is not mandatory. You can also use an existing user or GitHub app credentials. The
important
aspect is that Atlantis will perform actions and write comments under this user's name, so it should be recognizable
and
not confuse the workflow.</p>
</blockquote>
<p>In case you want to use a different user, you need to create new user (or use existing user) and access token. This
token will replace exiting user token, and should be manually updates in Vault. For mor details on secret management
please <a href="../../../operators_guide/platform_management/services/secrets/">see</a>.</p>
<p>Suggested token scope is "<code>Administration: Read-only</code>" and includes following permissions:</p>
<ul>
<li>Checks: Read and write.</li>
<li>Commit statuses: Read and write.</li>
<li>Contents: Read and write.</li>
<li>Issues: Read and write.</li>
<li>Metadata: Read-only (default).</li>
<li>Pull requests: Read and write.</li>
<li>Webhooks: Read and write.</li>
<li>Members: Read-only.</li>
</ul>
<p>To get a personal access token, also known as a "developer token", please
follow the steps as described
in <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token">GitHub guide</a>.</p>
<p>For the most accurate and up-to-date information, you should consult the Atlantis documentation and the GitHub
documentation for creating personal access tokens as these resources will have the latest guidelines and best practices
for setting up Atlantis with GitHub.</p>
<p>For more details on permission please
check <a href="../../../operators_guide/installation/quickstart/#configure-git-provider">setup guide</a></p>
<h2 id="cloud-access">Cloud Access</h2>
<p>Atlantis role for cloud provider access is managed via service account mechanism applied with annotation(s). For more
details on role mappings please see <a href="../../iam/iam/">IAM</a></p>
<p>Default role permissions should be adjusted based on your specific
needs. <a href="https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/what-is-access-analyzer.html">AWS IAM Access Analyzer</a> or
similar tools could be used to evaluate required permissions scope.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../argo_permissions/" class="btn btn-neutral float-left" title="Argo workflows permission scopes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../cost_management/cost_management/" class="btn btn-neutral float-right" title="Cost Management">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../argo_permissions/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../cost_management/cost_management/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
